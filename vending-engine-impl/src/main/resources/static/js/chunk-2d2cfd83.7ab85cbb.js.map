{"version":3,"sources":["webpack:///./src/views/Order.vue?3360","webpack:///./src/views/Order.vue?462b","webpack:///src/views/Order.vue","webpack:///./src/views/Order.vue?81a5","webpack:///./src/views/Order.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","stepStates","class","disable","disableHomeLink","attrs","_v","product","getBoxClass","paymentMethod","on","changePaymentMethod","setThirdStep","_e","price","setFirstStep","eventEndOrder","_s","getCashBack","$event","$router","push","staticRenderFns","component"],"mappings":"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","file":"js/chunk-2d2cfd83.7ab85cbb.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Order.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Order.vue?vue&type=style&index=0&lang=sass&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"order\"},[(_vm.stepStates[4] === 0)?_c('div',[_c('div',{staticClass:\"order__header\"},[_c('router-link',{staticClass:\"order__back\",class:{disable:_vm.disableHomeLink},attrs:{\"to\":\"/\"}},[_c('svg',{attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"viewBox\":\"0 0 512.006 512.006\"}},[_c('path',{attrs:{\"d\":\"M388.419,475.59L168.834,256.005L388.418,36.421c8.341-8.341,8.341-21.824,0-30.165s-21.824-8.341-30.165,0    L123.586,240.923c-8.341,8.341-8.341,21.824,0,30.165l234.667,234.667c4.16,4.16,9.621,6.251,15.083,6.251    c5.461,0,10.923-2.091,15.083-6.251C396.76,497.414,396.76,483.931,388.419,475.59z\"}})]),_c('span',[_vm._v(\"На главный экран\")])]),_c('OrderCard',{staticClass:\"order__card\",attrs:{\"product\":_vm.product}})],1),_c('div',{staticClass:\"order__main\"},[_c('div',{staticClass:\"order__box\",class:_vm.getBoxClass(1)},[_c('OrderBoxHeader',{attrs:{\"step\":\"1\",\"label\":\"Выберите способ оплаты\"}}),(_vm.stepStates[1])?_c('div',{staticClass:\"order__box-content\"},[_c('PaymentMethod',{attrs:{\"paramPaymentMethod\":_vm.paymentMethod},on:{\"changePaymentMethod\":_vm.changePaymentMethod,\"setThirdStep\":_vm.setThirdStep}})],1):_vm._e()],1),_c('div',{staticClass:\"order__box\",class:_vm.getBoxClass(2)},[_c('OrderBoxHeader',{attrs:{\"step\":\"2\",\"label\":\"Оплата\"}}),(_vm.stepStates[2])?_c('div',{staticClass:\"order__box-content\"},[_c('Payment',{attrs:{\"paymentMethod\":_vm.paymentMethod,\"sum\":_vm.product.price},on:{\"setFirstStep\":_vm.setFirstStep}})],1):_vm._e()],1),_c('div',{staticClass:\"order__box\",class:_vm.getBoxClass(3)},[_c('OrderBoxHeader',{attrs:{\"step\":\"3\",\"label\":\"Получение товара\"}}),(_vm.stepStates[3])?_c('div',{staticClass:\"order__box-content\"},[_c('ReceiptGood',{on:{\"eventEndOrder\":_vm.eventEndOrder}})],1):_vm._e()],1)])]):_c('div',{staticClass:\"end-step\"},[_c('img',{attrs:{\"src\":\"/icon-success.png\",\"alt\":\"success order\"}}),(_vm.paymentMethod === 1)?_c('div',{staticClass:\"cash-back\"},[_vm._v(\" Ваша сдача: \"+_vm._s(_vm.getCashBack())+\" ₽ \")]):_vm._e(),_c('h1',[_vm._v(\"Спасибо за покупку. Заберите товар в нижнем окне\")]),_c('button',{staticClass:\"button button_accent\",on:{\"click\":function($event){return _vm.$router.push('/')}}},[_vm._v(\"На главный экран\")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"order\">\n    <div v-if=\"stepStates[4] === 0\">\n      <div class=\"order__header\">\n        <router-link class=\"order__back\"\n                     :class=\"{disable:disableHomeLink}\"\n                     to=\"/\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 512.006 512.006\">\n            <path d=\"M388.419,475.59L168.834,256.005L388.418,36.421c8.341-8.341,8.341-21.824,0-30.165s-21.824-8.341-30.165,0    L123.586,240.923c-8.341,8.341-8.341,21.824,0,30.165l234.667,234.667c4.16,4.16,9.621,6.251,15.083,6.251    c5.461,0,10.923-2.091,15.083-6.251C396.76,497.414,396.76,483.931,388.419,475.59z\"/>\n          </svg>\n          <span>На главный экран</span>\n        </router-link>\n        <OrderCard :product=\"product\" class=\"order__card\" />\n      </div>\n      <div class=\"order__main\">\n        <div class=\"order__box\" v-bind:class=\"getBoxClass(1)\">\n          <OrderBoxHeader step=\"1\" label=\"Выберите способ оплаты\" />\n          <div class=\"order__box-content\"  v-if=\"stepStates[1]\">\n            <PaymentMethod\n              @changePaymentMethod=\"changePaymentMethod\"\n              @setThirdStep=\"setThirdStep\"\n              :paramPaymentMethod=\"paymentMethod\"/>\n          </div>\n        </div>\n        <div class=\"order__box\" v-bind:class=\"getBoxClass(2)\">\n          <OrderBoxHeader step=\"2\" label=\"Оплата\" />\n          <div class=\"order__box-content\" v-if=\"stepStates[2]\">\n            <Payment v-bind:paymentMethod=\"paymentMethod\"\n                     v-bind:sum=\"product.price\"\n                     @setFirstStep=\"setFirstStep\"/>\n          </div>\n        </div>\n        <div class=\"order__box\" v-bind:class=\"getBoxClass(3)\">\n          <OrderBoxHeader step=\"3\" label=\"Получение товара\" />\n          <div class=\"order__box-content\"  v-if=\"stepStates[3]\">\n            <ReceiptGood @eventEndOrder=\"eventEndOrder\" />\n          </div>\n        </div>\n      </div>\n    </div>\n    <div v-else class=\"end-step\">\n      <img src=\"/icon-success.png\" alt=\"success order\">\n      <div v-if=\"paymentMethod === 1\" class=\"cash-back\">\n        Ваша сдача: {{getCashBack()}} ₽\n      </div>\n      <h1>Спасибо за покупку. Заберите товар в нижнем окне</h1>\n      <button @click=\"$router.push('/')\" class=\"button button_accent\">На главный экран</button>\n    </div>\n  </div>\n</template>\n\n<script>\n  import { mapGetters } from 'vuex'\n  import axios from \"axios\";\n\n  export default {\n    name: 'Order',\n    created() {\n      this.dev_mode = process.env.NODE_ENV === 'development' ? 1 : 0\n      const prodId = this.$route.params.id\n      this.$store.commit('setProduct', prodId)\n    },\n    updated() {\n      if(this.stepStates[4] ){\n        this.returnOfCashback()\n      }\n    },\n    data: function() {\n      return {\n        paymentMethod: 0,\n        stepStates: {1:1,2:0,3:0,4:0},\n        disableHomeLink: false\n      }\n    },\n    methods: {\n      getBoxClass(step){\n        switch (this.stepStates[step]) {\n          case 1:\n            return 'is-active'\n          case 2:\n            return 'is-done'\n          default:\n            return ''\n        }\n      },\n      changePaymentMethod(methodId = 0){\n        this.paymentMethod = methodId\n        if(methodId) {\n          this.stepStates[1] = 2\n          this.stepStates[2] = 1\n        } else {\n          this.stepStates[1] = 1\n          this.stepStates[2] = 0\n        }\n      },\n      setFirstStep(){\n        this.paymentMethod = 0\n        this.stepStates = {1:1,2:0,3:0,4:0}\n      },\n      setThirdStep() {\n        this.stepStates[2] = 2\n        this.stepStates[3] = 1\n      },\n      eventEndOrder() {\n        this.stepStates[4] = 2\n      },\n      getCashBack() {\n        return this.incomeSum - this.product.price\n      },\n      returnOfCashback() {\n        const cashback = this.getCashBack()\n        if (cashback){\n          let url, response\n          try {\n            if(this.dev_mode){\n              url = `dispense${cashback}.json`\n              response = axios.get(url);\n            } else {\n              url = 'dispense/' + cashback\n              response = axios.post(url);\n            }\n          } catch (e) {console.warn(e.message)}\n          response.then((r) => {console.log('Response for dispense',r.data)})\n        }\n      }\n    },\n    watch: {\n      incomeSum: function(newVal) {\n        if (newVal) {\n          this.disableHomeLink = true\n        }\n      }\n    },\n    computed: {\n      ...mapGetters(['product','incomeSum'])\n    },\n    beforeRouteLeave(to, from, next) {\n      if(this.incomeSum && this.stepStates[4] === 0) {\n        this.disableHomeLink = true\n        next(false)\n      } else {\n        this.disableHomeLink = false\n        next()\n      }\n    }\n  }\n</script>\n\n<style lang=\"sass\">\n  .order\n    display: flex\n    flex-direction: column\n    height: 100%\n    &__header\n      background-color: $g-color-white\n      padding: 24px\n    &__main\n      flex-grow: 1\n      background-color: $g-color-grey\n      padding: 24px\n      .order__box:last-child\n        .order__box-content::before\n          content: none\n    &__back\n      display: flex\n      align-items: center\n      text-decoration: none\n      margin-bottom: 24px\n      svg\n        width: 20px\n        height: 20px\n        margin-right: 8px\n    &__box\n      $box: &\n      &.is-active\n        #{$box}\n          &-step\n            background-color: $color-order-step-active\n          &-content\n            &::before\n              border-left-color: $color-order-step-active\n      &.is-done\n        #{$box}\n          &-step\n            background-color: $color-order-step-done\n          &-content\n            &::before\n              border-left-color: $color-order-step-done\n      &-content\n        position: relative\n        // min-height: 100px\n        padding: 0 16px 0 44px\n        margin-left: 14px\n        margin-bottom: 16px\n        &::before\n          content: ''\n          position: absolute\n          left: 0\n          top: 0\n          width: 2px\n          height: 100%\n          border-left: 2px dotted $color-order-step\n  .end-step\n    text-align: center\n    padding: 100px 50px\n    img\n      display: block\n      margin: 50px auto\n    .cash-back\n      background-color: #f5f5f5\n      border: 1px solid $g-color-border\n      border-radius: 5px\n      bottom: -25px\n      margin: auto\n      padding: 12px 30px\n      position: relative\n      width: fit-content\n    h1\n      border-bottom: 1px solid $g-color-border\n      border-top: 1px solid $g-color-border\n      font-weight: 500\n      margin-bottom: 100px\n      padding: 50px 100px\n    button\n      font-size: 18px\n      padding: 15px 30px\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Order.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Order.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Order.vue?vue&type=template&id=753b9169&\"\nimport script from \"./Order.vue?vue&type=script&lang=js&\"\nexport * from \"./Order.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Order.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}